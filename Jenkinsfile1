def artifactname = "devops-snow-build-app.jar"
def repoName = "JenkinsDevOpsProject"
def pipelineName = "SunilPipelines/Sunil-Scripted-Pipeline-Sonar"
def semanticVersion = "${env.BUILD_NUMBER}.0.0"
def packageName = "devops-snow-build-prasad_pkg_${env.BUILD_NUMBER}"
def version = "${env.BUILD_NUMBER}.0"
def pkgName = "devops-snow-build-prasad_pkg_${env.BUILD_NUMBER}"

pipeline {
  agent any
 
  stages {
       stage('Build') {
           steps {
              
              sh 'mvn -B -DskipTests clean compile'

           }
       }
       stage('Example1') {
            steps {
                echo 'Hello World'
            writeFile file: "/tmp/app-devops-jenkins1-${env.BUILD_NUMBER}-SNAPSHOT.jar", text: 'This is a test'
    
            }
            
            post { 
                always { 
        script { 
                 def server = Artifactory.server 'JFrog1'
                 def uploadSpec = """{
                    "files": [{
                       "pattern": "/tmp/app-devops-jenkins1-${env.BUILD_NUMBER}-SNAPSHOT.jar",
                       "target": "felipe-repo/${env.BUILD_NUMBER}/"
                    }]
                 }"""

              def buildInfo = server.upload(uploadSpec) 
              server.publishBuildInfo buildInfo   
        }}}
	}
       	stage('Example2') {
            steps {
                echo 'Hello World'
            writeFile file: "/tmp/app-devops-jenkins2-${env.BUILD_NUMBER}-SNAPSHOT.jar", text: 'This is a test'
    
            }
            
            post { 
                always { 
        script { 
                 def server = Artifactory.server 'JFrog1'
                 def uploadSpec = """{
                    "files": [{
                       "pattern": "/tmp/app-devops-jenkins2-${env.BUILD_NUMBER}-SNAPSHOT.jar",
                       "target": "felipe-repo/${env.BUILD_NUMBER}/"
                    }]
                 }"""

              def buildInfo = server.upload(uploadSpec) 
              server.publishBuildInfo buildInfo   
        }}}
	}
       	stage('Example3') {
            steps {
                echo 'Hello World'
            writeFile file: "/tmp/app-devops-jenkins3-${env.BUILD_NUMBER}-SNAPSHOT.jar", text: 'This is a test'
    
            }
            
            post { 
                always { 
        script { 
                 def server = Artifactory.server 'JFrog1'
                 def uploadSpec = """{
                    "files": [{
                       "pattern": "/tmp/app-devops-jenkins3-${env.BUILD_NUMBER}-SNAPSHOT.jar",
                       "target": "felipe-repo/${env.BUILD_NUMBER}/"
                    }]
                 }"""

              def buildInfo = server.upload(uploadSpec) 
              server.publishBuildInfo buildInfo   
        }}}
	}
       	stage('Example4') {
            steps {
                echo 'Hello World'
            writeFile file: "/tmp/app-devops-jenkins4-${env.BUILD_NUMBER}-SNAPSHOT.jar", text: 'This is a test'
    
            }
            
            post { 
                always { 
        script { 
                 def server = Artifactory.server 'JFrog1'
                 def uploadSpec = """{
                    "files": [{
                       "pattern": "/tmp/app-devops-jenkins4-${env.BUILD_NUMBER}-SNAPSHOT.jar",
                       "target": "felipe-repo/${env.BUILD_NUMBER}/"
                    }]
                 }"""

              def buildInfo = server.upload(uploadSpec) 
              server.publishBuildInfo buildInfo   
        }}}
	}
  	stage('Example5') {
            steps {
                echo 'Hello World'
            writeFile file: "/tmp/app-devops-jenkins5-${env.BUILD_NUMBER}-SNAPSHOT.jar", text: 'This is a test'
    
            }
            
            post { 
                always { 
        script { 
                 def server = Artifactory.server 'JFrog1'
                 def uploadSpec = """{
                    "files": [{
                       "pattern": "/tmp/app-devops-jenkins5-${env.BUILD_NUMBER}-SNAPSHOT.jar",
                       "target": "felipe-repo/${env.BUILD_NUMBER}/"
                    }]
                 }"""

              def buildInfo = server.upload(uploadSpec) 
              server.publishBuildInfo buildInfo   
        }}}
	}
      stage('Deploy') {
                 steps {
                    

		    snDevOpsChange(ignoreErrors:false)
                    
                 }
      }


 }
 
}
